# ============================================================
# Main Docker Environment Configuration File
# ============================================================

# ------------------------------------------------------------
# GLOBAL SETTINGS
# ------------------------------------------------------------
COMPOSE_PROJECT_NAME=langflow-stack
TZ=UTC

# ------------------------------------------------------------
# OLLAMA CONFIGURATION
# ------------------------------------------------------------
# Container settings
OLLAMA_CONTAINER_NAME=ollama
OLLAMA_HOST=ollama.local
OLLAMA_PORT=11434

# Internal and external URLs
OLLAMA_INTERNAL_URL=http://ollama:11434
EXTERNAL_OLLAMA_URL=http://localhost:11434

# Ollama-specific configuration
OLLAMA_MODELS=nomic-embed-text
OLLAMA_ALLOW_DOWNLOAD=true
OLLAMA_ALLOW_UPLOAD=true

# ------------------------------------------------------------
# QDRANT CONFIGURATION
# ------------------------------------------------------------
# Container settings
QDRANT_CONTAINER_NAME=qdrant
QDRANT_HOST=qdrant.local
QDRANT_PORT=6333
QDRANT_INTERNAL_PORT=6334

# Internal and external URLs
QDRANT_INTERNAL_URL=http://qdrant:6333
EXTERNAL_QDRANT_URL=http://localhost:6333

# Qdrant-specific configuration
QDRANT_ALLOW_CORS=true
QDRANT_TELEMETRY_DISABLED=true
QDRANT_LOG_LEVEL=INFO

# ------------------------------------------------------------
# DATABASE CONFIGURATION
# ------------------------------------------------------------

# PostgreSQL settings
POSTGRES_CONTAINER_NAME=postgres
POSTGRES_HOST=postgres
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_SSL_MODE=disable
PG_COLOR=always
POSTGRES_DB=langflow
POSTGRES_PORT=5432
PGCONNECT_TIMEOUT=30
PGCLIENTENCODING=utf8

# ------------------------------------------------------------
# LANGFLOW CONFIGURATION
# ------------------------------------------------------------
# Container settings
LANGFLOW_CONTAINER_NAME=langflow
LANGFLOW_HOST=0.0.0.0
LANGFLOW_PORT=7860

# Internal and external URLs
LANGFLOW_INTERNAL_URL=http://langflow:7860
EXTERNAL_LANGFLOW_URL=http://localhost:7860

# Langflow Database Connection
LANGFLOW_DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?sslmode=${POSTGRES_SSL_MODE}&application_name=langflow&connect_timeout=10

# Langflow-specific configuration
LANGFLOW_AUTO_RELOAD=true
LANGFLOW_DEV=false
LANGFLOW_CACHE=true
LANGFLOW_REMOVE_EXAMPLE_FLOWS=true
LANGFLOW_EMBEDDING_MODEL_ENDPOINT=${OLLAMA_INTERNAL_URL}
LANGFLOW_ALLOWED_ORIGINS=*
DO_NOT_TRACK=true
LANGFLOW_STORE_ENVIRONMENT_VARIABLES=true
LANGFLOW_AUTO_MIGRATE=true

# Authentication configuration
LANGFLOW_SUPERUSER=admin
LANGFLOW_SUPERUSER_PASSWORD=admin
LANGFLOW_SECRET_KEY=insert-secret-key
LANGFLOW_AUTO_LOGIN=false
LANGFLOW_AUTO_APPROVE_USERS=true
LANGFLOW_DISABLE_TOKEN_GENERATION=false
LANGFLOW_ALLOW_USER_REGISTRATION=true

# ------------------------------------------------------------
# BACKEND CONFIGURATION
# ------------------------------------------------------------
# Container settings
BACKEND_CONTAINER_NAME=backend
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
BACKEND_LF_USERNAME=${LANGFLOW_SUPERUSER}
BACKEND_LF_PASSWORD=${LANGFLOW_SUPERUSER_PASSWORD}

# Internal and external URLs
BACKEND_INTERNAL_URL=http://backend:8000
EXTERNAL_BACKEND_URL=http://localhost:8000

# Dependencies URLs (using the variables defined above)
BACKEND_OLLAMA_URL=${OLLAMA_INTERNAL_URL}
BACKEND_QDRANT_URL=${QDRANT_INTERNAL_URL}
BACKEND_LANGFLOW_URL=${LANGFLOW_INTERNAL_URL}

# Backend-specific configuration
BACKEND_LOG_LEVEL=INFO
BACKEND_ALLOW_ORIGINS=*
BACKEND_UPLOAD_DIR=/app/uploads
BACKEND_MAX_FILE_SIZE=100MB
BACKEND_DEFAULT_EMBEDDING_MODEL=nomic-embed-text

# ------------------------------------------------------------
# FRONTEND CONFIGURATION
# ------------------------------------------------------------
# Container settings
FRONTEND_CONTAINER_NAME=frontend
FRONTEND_PORT=3000

# API Endpoints (using external URLs for browser access)
REACT_APP_LANGFLOW_API=${EXTERNAL_LANGFLOW_URL}
REACT_APP_BACKEND_API=${EXTERNAL_BACKEND_URL}

# React development settings
NODE_ENV=development
WDS_SOCKET_HOST=0.0.0.0
CHOKIDAR_USEPOLLING=true
FAST_REFRESH=true
BROWSER=none

# Frontend-specific configuration
REACT_APP_DEFAULT_FLOW_ID=""
REACT_APP_VERSION=1.0.0