# ============================================================
# Main Docker Environment Configuration File
# ============================================================

# ------------------------------------------------------------
# GLOBAL SETTINGS
# ------------------------------------------------------------
COMPOSE_PROJECT_NAME=langflow-stack
TZ=UTC

# ------------------------------------------------------------
# SERVICE PORTS
# ------------------------------------------------------------
FRONTEND_PORT=3000
BACKEND_PORT=8000
LANGFLOW_PORT=7860
POSTGRES_PORT=5432
ADMINER_PORT=8080
OLLAMA_PORT=11434
QDRANT_PORT=6333
QDRANT__SERVICE__HTTP_PORT=6333
QDRANT__SERVICE__GRPC_PORT=6334

# ------------------------------------------------------------
# CONTAINER NAMES
# ------------------------------------------------------------
FRONTEND_CONTAINER_NAME=frontend
BACKEND_CONTAINER_NAME=backend
LANGFLOW_CONTAINER_NAME=langflow
POSTGRES_CONTAINER_NAME=postgres
ADMINER_CONTAINER_NAME=adminer
QDRANT_CONTAINER_NAME=qdrant
OLLAMA_CONTAINER_NAME=ollama

# ------------------------------------------------------------
# EXTERNAL URLS (What users access in browser)
# ------------------------------------------------------------
FRONTEND_URL=http://localhost:${FRONTEND_PORT}
BACKEND_URL=http://localhost:${BACKEND_PORT}
LANGFLOW_URL=http://localhost:${LANGFLOW_PORT}
ADMINER_URL=http://localhost:${ADMINER_PORT}

# ------------------------------------------------------------
# INTERNAL URLS (Container-to-container communication)
# ------------------------------------------------------------

FRONTEND_INTERNAL_URL=http://${FRONTEND_CONTAINER_NAME}:${FRONTEND_PORT}
BACKEND_INTERNAL_URL=http://${BACKEND_CONTAINER_NAME}:${BACKEND_PORT}
LANGFLOW_INTERNAL_URL=http://${LANGFLOW_CONTAINER_NAME}:${LANGFLOW_PORT}
QDRANT_INTERNAL_URL=http://${QDRANT_CONTAINER_NAME}:${QDRANT_PORT}
OLLAMA_INTERNAL_URL=http://${OLLAMA_CONTAINER_NAME}:${OLLAMA_PORT}


# ------------------------------------------------------------
# BACKEND API ROUTE ENDPOINTS
# ------------------------------------------------------------

# Health endpoints
HEALTH_BASE_ENDPOINT=/health
HEALTH_OLLAMA_ENDPOINT=/ollama
HEALTH_QDRANT_ENDPOINT=/qdrant
HEALTH_LANGFLOW_ENDPOINT=/langflow

# User management endpoints
USERS_BASE_ENDPOINT=/api/users
USERS_CREATE_ENDPOINT=
USERS_DELETE_ENDPOINT=/{user_id}
USERS_LOGIN_ENDPOINT=/login
USERS_REFRESH_TOKEN_ENDPOINT=/refresh-token
USERS_LOGOUT_ENDPOINT=/logout
USERS_VERIFY_AUTH_ENDPOINT=/verify-auth
USERS_AUTH_STATUS_ENDPOINT=/auth-status

# Flow management endpoints
FLOWS_BASE_ENDPOINT=/api/flows
FLOWS_UPLOAD_ENDPOINT=/upload
FLOWS_PUBLIC_ENDPOINT=/public
FLOWS_GET_BY_ID_ENDPOINT=/{flow_id}
FLOWS_COMPONENT_IDS_ENDPOINT=/{flow_id}/component-ids
FLOWS_DELETE_ENDPOINT=/{flow_id}
FLOWS_DELETE_MULTIPLE_ENDPOINT=
FLOWS_RUN_ENDPOINT=/{flow_id}/run
FLOWS_VALIDATE_ENDPOINT=/{flow_id}/validate

# Message/Chat endpoints
MESSAGES_BASE_ENDPOINT=/api/messages
MESSAGES_SEND_ENDPOINT=/send
MESSAGES_SESSION_INFO_ENDPOINT=/session/{session_id}
MESSAGES_LIST_SESSIONS_ENDPOINT=/sessions
MESSAGES_END_SESSION_ENDPOINT=/session/{session_id}

# Redirect endpoints
REDIRECT_BASE_ENDPOINT=/api/redirect
REDIRECT_LANGFLOW_ENDPOINT=/redirect-langflow

# Collection Endpoints
COLLECTIONS_BASE_ENDPOINT=/api/collections
COLLECTIONS_CREATE_ENDPOINT=/{flow_id}
COLLECTIONS_DELETE_ENDPOINT=/{flow_id}
COLLECTIONS_FILES_ENDPOINT=/files
COLLECTIONS_UPLOAD_ENDPOINT=/files/upload
COLLECTIONS_DELETE_FILE_ENDPOINT=/files
COLLECTIONS_INFO_ENDPOINT=/{flow_id}/info
COLLECTIONS_LIST_FILES_ENDPOINT=/{flow_id}/files
COLLECTIONS_UPLOAD_TO_COLLECTION_ENDPOINT=/{flow_id}/files/upload
COLLECTIONS_DELETE_FROM_COLLECTION_ENDPOINT=/{flow_id}/files
COLLECTIONS_PROCESSING_ENDPOINT=/{flow_id}/processing
COLLECTIONS_DELETE_PROCESSING_ENDPOINT=/{flow_id}/processing/{file_id}

# File Conversion
FILE_BASE_ENDPOINT=/api/files
FILE_CONVERSION_ENDPOINT=/convert

# ------------------------------------------------------------
# LANGFLOW API ROUTE ENDPOINTS (used by backend)
# ------------------------------------------------------------
# Authentication routes
LF_AUTH_LOGIN_ENDPOINT=/api/v1/login
LF_AUTH_REFRESH_ENDPOINT=/api/v1/refresh
LF_AUTH_LOGOUT_ENDPOINT=/api/v1/logout
LF_USER_WHOAMI=/api/v1/users/whoami

# User management routes
LF_USERS_BASE_ENDPOINT=/api/v1/users/
LF_USERS_DETAIL_ENDPOINT=/api/v1/users/{user_id}

# Flow management routes
LF_FLOWS_BASE_ENDPOINT=/api/v1/flows/
LF_FLOWS_UPLOAD_ENDPOINT=/api/v1/flows/upload/
LF_FLOWS_DETAIL_ENDPOINT=/api/v1/flows/{flow_id}

# Flow execution routes
LF_RUN_FLOW_ENDPOINT=/api/v1/run/{flow_id}

# ------------------------------------------------------------
# COLLECTION CONFIGURATION
# ------------------------------------------------------------

CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# ------------------------------------------------------------
# DATABASE CONFIGURATION
# ------------------------------------------------------------
POSTGRES_HOST=postgres
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_DB=langflow
POSTGRES_SSL_MODE=disable
PGCONNECT_TIMEOUT=30
PGCLIENTENCODING=utf8

# Database connection URL
LANGFLOW_DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?sslmode=${POSTGRES_SSL_MODE}&application_name=langflow&connect_timeout=10

# ------------------------------------------------------------
# LANGFLOW CONFIGURATION
# ------------------------------------------------------------
LANGFLOW_HOST=0.0.0.0
LANGFLOW_AUTO_RELOAD=true
LANGFLOW_DEV=false
LANGFLOW_CACHE=true
LANGFLOW_REMOVE_EXAMPLE_FLOWS=true
LANGFLOW_ALLOWED_ORIGINS=*
DO_NOT_TRACK=true
LANGFLOW_STORE_ENVIRONMENT_VARIABLES=true
LANGFLOW_AUTO_MIGRATE=true

# Authentication
LANGFLOW_SUPERUSER=admin
LANGFLOW_SUPERUSER_PASSWORD=admin
LANGFLOW_SECRET_KEY=your-secret-key-here
LANGFLOW_AUTO_LOGIN=false
LANGFLOW_AUTO_APPROVE_USERS=true
LANGFLOW_DISABLE_TOKEN_GENERATION=false
LANGFLOW_ALLOW_USER_REGISTRATION=true

# Components
TEMPLATE_PATH=/app/custom_components/media/template.pptx
EXTENDED_TEMPLATE_PATH=/app/custom_components/media/extended_template.pptx

# ------------------------------------------------------------
# BACKEND CONFIGURATION
# ------------------------------------------------------------
BACKEND_HOST=0.0.0.0
BACKEND_LF_USERNAME=${LANGFLOW_SUPERUSER}
BACKEND_LF_PASSWORD=${LANGFLOW_SUPERUSER_PASSWORD}
BACKEND_LOG_LEVEL=INFO
BACKEND_ALLOW_ORIGINS=*
BACKEND_UPLOAD_DIR=/app/uploads
BACKEND_MAX_FILE_SIZE=100MB

IMAGE_TIMEOUT=300

DEFAULT_EMBEDDING_MODEL=dengcao/Qwen3-Embedding-8B:Q5_K_M

USE_GOOGLE_VISION=True
DEFAULT_VISION_MODEL=llava
DEFAULT_GOOGLE_VISION=gemini-2.5-flash
GOOGLE_API_KEY=AIzaSyA9Cq3Phx1MmNIFMxaCEX5R9cvaYahC5o4

PPTX_MAGIC_BYTES=LF_GENERATED_PPTX_9481
DOCX_MAGIC_BYTES=LF_GENERATED_DOCX_2749

# ------------------------------------------------------------
# FRONTEND CONFIGURATION
# ------------------------------------------------------------
# React development settings
NODE_ENV=development
WDS_SOCKET_HOST=0.0.0.0
CHOKIDAR_USEPOLLING=true
FAST_REFRESH=true
BROWSER=none

LOGIN_ROUTE=/login
DASHBOARD_ROUTE=/dashboard

# API endpoints (frontend uses external URLs)
REACT_APP_BACKEND_API=${BACKEND_URL}
REACT_APP_LANGFLOW_API=${LANGFLOW_URL}

# App config
REACT_APP_VERSION=1.0.0
REACT_APP_DEFAULT_FLOW_ID=""
FILE_POLLING_INTERVAL=10000


# ------------------------------------------------------------
# OLLAMA CONFIGURATION
# ------------------------------------------------------------
OLLAMA_CHAT_MODELS=llama3.2:3b
OLLAMA_HOST=0.0.0.0

OLLAMA_TAGS_ENDPOINT=/api/tags
OLLAMA_EMBEDDINGS_ENDPOINT=/api/embeddings
OLLAMA_GENERATE_ENDPOINT=/api/generate
OLLAMA_MODELS_ENDPOINT=/api/show

# ------------------------------------------------------------
# QDRANT CONFIGURATION
# ------------------------------------------------------------

QDRANT_COLLECTIONS_ENDPOINT=/collections
QDRANT_POINTS_ENDPOINT=/collections/{collection_name}/points
QDRANT_SEARCH_ENDPOINT=/collections/{collection_name}/points/search
QDRANT_SCROLL_ENDPOINT=/collections/{collection_name}/points/scroll

# ------------------------------------------------------------
# Adminer CONFIGURATION
# ------------------------------------------------------------
ADMINER_DEFAULT_SERVER=${POSTGRES_HOST}
ADMINER_DESIGN=flat


# ------------------------------------------------------------
# Cookie CONFIGURATION
# ------------------------------------------------------------
ACCESS_COOKIE_NAME=dashboard_access_token
REFRESH_COOKIE_NAME=dashboard_refresh_token
USERNAME_COOKIE_NAME=dashboard_username